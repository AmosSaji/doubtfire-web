<mat-card class="user-settings-modal">
  <mat-card-title>
    {{ isNew ? 'Create User' : 'Edit User' }}
  </mat-card-title>
  <mat-card-content class="user-settings-form-content">
    <div *ngIf="!isNew" class="row" style="margin-bottom:5px;">
      <label class="col-sm-3" for="username">Username</label>
      <div class="col-sm-9">{{ user.username }}</div>
    </div>
    <div *ngIf="isNew">
      <mat-form-field appearance="fill" ng-required="isNew" class="width-half">
        <mat-label>Username</mat-label>
        <input type="text" matInput [(ngModel)]="user.username" placeholder="1744070">
      </mat-form-field>
    </div>
    <div>
      <mat-form-field appearance="fill" ng-required="isNew" class="width-half">
        <mat-label>First Name</mat-label>
        <input type="text" matInput [(ngModel)]="user.first_name" placeholder="Name">
      </mat-form-field>
    </div>
    <div>
      <mat-form-field appearance="fill" ng-required="isNew" class="width-half">
        <mat-label>Last Name</mat-label>
        <input type="text" matInput [(ngModel)]="user.last_name" placeholder="Surname">
      </mat-form-field>
    </div>
    <div>
      <mat-form-field appearance="fill" ng-required="isNew" class="width-half">
        <mat-label>Preferred Name</mat-label>
        <input type="text" matInput [(ngModel)]="user.nickname" placeholder="Nickname">
      </mat-form-field>
    </div>
    <div>
      <mat-form-field appearance="fill" ng-required="isNew" class="width-half">
        <mat-label>Email</mat-label>
        <input type="email" matInput [(ngModel)]="user.email" placeholder="name@university.edu">
      </mat-form-field>
    </div>
    <hr />
    <div *ngIf="user.system_role === 'Student'">
      <mat-form-field appearance="fill" ng-required="isNew" class="width-half">
        <mat-label>Student ID</mat-label>
        <input type="email" matInput [(ngModel)]="user.student_id" placeholder="1744070">
      </mat-form-field>
      <span class="help-block">Please ensure your institution's student identification number matches this value</span>
    </div>
    <div>
      <label>Avatar</label>
      <div>
        <div>
          <user-icon [size]="50" [user]="user" style="max-width: 50px; max-height: 50px; font-size: 18px; margin-bottom: 5px;"></user-icon>
          <a href="http://en.gravatar.com/support/activating-your-account/" target="_blank"
            class="btn btn-sm btn-default">
            Change Avatar
          </a>
        </div>
        <p class="help-block">
          Sign up to
          <a href="http://en.gravatar.com/support/activating-your-account/" target="_blank">Gravatar</a> and associate
          your email above to your account to give yourself an avatar
        </p>
      </div>
    </div>
    <div if-role="Admin Convenor" ng-required="isNew">
      <mat-form-field appearance="fill" ng-required="isNew" class="width-half">
        <mat-label>System Role</mat-label>
        <mat-select [(ngModel)]="user.system_role">
          <mat-option value="Administrator">Administrator</mat-option>
          <mat-option value="Convenor">Convenor</mat-option>
          <mat-option value="Tutor">Tutor</mat-option>
          <mat-option value="Student">Student</mat-option>
        </mat-select>
      </mat-form-field>
      <span *ngIf="user.id === CurrentUser.id" class="help-block text-center">You cannot modify your own
        permissions</span>
    </div>
    <div *ngIf="!isNew && user.id === CurrentUser.id">
      <hr />
      <div class="form-group">
        <label>Allow Analytics</label>
        <div>
          <mat-checkbox class="example-margin" [(ngModel)]="user.opt_in_to_research">Checked</mat-checkbox>
          <p class="help-block">Allow us to anonymously gather your usage to improve {{ externalName }}</p>
        </div>
      </div>
    </div>
  </mat-card-content>
  <mat-divider></mat-divider>
  <mat-card-actions align="end">
    <button mat-raised-button (click)="dismiss()">Dismiss</button>
    <button mat-raised-button color="primary" (click)="saveUser()">
      {{ isNew ? 'Add' : 'Save' }}
    </button>
  </mat-card-actions>
</mat-card>
